<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title></title>

	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">

	<style class="--layout">
		.tracks {
			list-style:none;
		}

		.tracks .track {
			margin-top:50px;
		}

		.track-waveform-container .track-waveform-overlay {
			top:0;
			bottom:0;
			left:0;
			right:0;
			position:absolute;
		}

		.track:hover .track-overlay{ }
		.track .track-title { }
		.track .track-waveform-container {
			position:relative;
		}


		.track .track-waveform {
			height:40px;
			width:100%;
		}

		.track .track-info {
		}
	</style>

	<style class="--design">
		.tracks {
			list-style:none;
		}

		.track .track-waveform-container {
		}

		.track-waveform-container .track-waveform-overlay {
			color:#FFF;
			cursor:pointer;
			text-align:center;
			background-color:rgba(0,0,0,0.7);
			opacity:0;
			transition:opacity 0.2s linear;
		}
		.track-waveform-container:hover .track-waveform-overlay {
			opacity:1;
		}

		.track .track-title { }
		.track .track-waveform-container { }
		.track .track-waveform {
			background:#000;
		}

		.track .track-info { }
	</style>
</head>
<body>
<div class="container">
<ul class="tracks">
{{#each tracks}}
	<li class="" >
		<div class="tracks-track track">
			<div class="track-soundcloud-container" data-track-permalink="{{permalink_url}}"></div>
			<a class="track-waveform-overlay track-detect-beat" href="/tracks/{{id}}/beats">Detect beats</a>
			<a class="track-waveform-overlay track-play-with-beat" href="/track/{{id}}/beats/stream">Play with beat</a>
			<audio src="/tracks/{{id}}/beats/stream" preload='none' controls></audio>
		</div>
	</li>
{{/each}}
</ul>
</div>

<script src="//connect.soundcloud.com/sdk.js"></script>
<script>
  SC.initialize({});
</script>
<script>
(function(){
	var list = document.querySelectorAll('.track-soundcloud-container');
	for (var i=0, n=list.length ; i<n ; i++) {
		var elem = list[i];
		SC.oEmbed(elem.getAttribute('data-track-permalink'),{maxheight:166},elem);
	}

	var tracks = document.querySelector('.tracks');
	tracks.addEventListener('click',function(event){
		var target = event.target;
		if (target.classList.contains('track-detect-beat')) {
			event.preventDefault();
			event.stopPropagation();
		}

		if (target.classList.contains('track-play-with-beat')) {
			event.preventDefault();
			event.stopPropagation();
		}
	},false);
})();
</script>

</body>
</html>
